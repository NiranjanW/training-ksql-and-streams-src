# Instructions

1. Make sure Kafka is running:

    ```
    $ docker-compose up -d
    ```

2. Build the application:

    ```
    $ docker run -it --rm \
        -v "$PWD":/usr/src/app \
        -v "$HOME"/.m2:/root/.m2 \
        -w /usr/src/app \
        maven:3.5.3-jdk-8-alpine mvn clean install
    ```

3. Run the application:

    ```
    $ docker container run --rm \
        --net streams_streams-net \
        -v $(PWD)/target/map-sample-0.1.0.jar:/app.jar \
        openjdk:8-jre-alpine java -jar /app.jar
    ```

4. Create some input data

    ```
    docker-compose exec kafka sh -c 'cat << EOF | kafka-console-producer \
        --broker-list kafka:9092 \
        --property "parse.key=true" \
        --property "key.separator=:" \
        --key-serializer=org.apache.kafka.common.serialization.StringSerializer \
        --value-serializer=org.apache.kafka.common.serialization.StringSerializer \
        --topic lines-topic
    1:"Kafka powers the Confluent Streaming Platform"
    2:"Events are stored in Kafka"
    3:"Confluent contributes to Kafka"
    EOF'
    ```

5. Double check that output was generated by your application:

    ```
    $ docker-compose exec kafka kafka-console-consumer \
        --bootstrap-server kafka:9092 \
        --key-deserializer=org.apache.kafka.common.serialization.StringDeserializer \
        --value-deserializer=org.apache.kafka.common.serialization.StringDeserializer \
        --from-beginning \
        --topic lines-lower-topic
    ```

NOTE: 

1. To list all topics in Kafka use:

    ```
    $ docker-compose exec kafka kafka-topics \
        --zookeeper zookeeper:32181 \
        --list
    ```

2. To delete a topic (e.g. the `lines-topic`) use:

    ```
    $ docker-compose exec kafka kafka-topics \
        --zookeeper zookeeper:32181 \
        --delete \
        --topic lines-topic
    ```
